<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Reviews</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="/css/navbar.css">
	<style>
		* { box-sizing: border-box; }
		body {
			margin: 0;
			font-family: 'Patrick Hand', cursive;
			background: #f5f5f5;
			color: #111827;
		}
		.container {
			max-width: 1100px;
			margin: 40px auto;
			padding: 0 20px 60px;
		}
		.page-header {
			background: #fff;
			border-radius: 12px;
			padding: 20px 24px;
			margin-bottom: 18px;
			display: flex;
			justify-content: space-between;
			align-items: center;
			box-shadow: 0 4px 10px rgba(0,0,0,0.06);
		}
		h1 { margin: 0; color: #ff6b9d; font-size: 28px; }
		.muted { color: #6b7280; font-size: 14px; }
		.review-list { display: flex; flex-direction: column; gap: 12px; }
		.card {
			background: #fff;
			border-radius: 12px;
			padding: 16px 18px;
			box-shadow: 0 4px 10px rgba(0,0,0,0.06);
		}
		.card-head { display: flex; justify-content: space-between; gap: 10px; align-items: center; }
		.product { font-weight: 700; color: #111827; }
		.author { color: #6b7280; font-size: 13px; }
		.comment { margin: 10px 0 0; white-space: pre-wrap; line-height: 1.5; }
		.pill { display: inline-block; padding: 4px 10px; border-radius: 10px; background: #f3f4f6; font-size: 12px; }
		.stars { display: inline-flex; gap: 2px; font-size: 16px; color: #f59e0b; }
		.empty { padding: 40px; text-align: center; color: #6b7280; background: #fff; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.06); }
		@media (max-width: 768px) {
			.card-head { flex-direction: column; align-items: flex-start; }
		}
	</style>
</head>
<body>
	<%- include('partials/navbar') %>
	<div class="container">
		<div class="page-header">
			<div>
				<h1><%= isAdminView ? 'All Reviews' : 'My Reviews' %></h1>
				<div class="muted"><%= isAdminView ? 'Reviews from all users' : 'Reviews you have written' %></div>
			</div>
		</div>

		<% if (reviews && reviews.length) { %>
			<div class="review-list">
				<% reviews.forEach(r => { %>
					<div class="card">
						<div class="card-head">
							<div>
								<div class="product"><%= r.product_name || 'Product #' + r.product_id %></div>
								<div class="muted">
									<%= new Date(r.created_at || Date.now()).toLocaleDateString() %>
									<% if (isAdminView) { %>
										• <%= r.username || ('User #' + r.user_id) %>
										<% if (r.email) { %> (<%= r.email %>) <% } %>
									<% } %>
								</div>
							</div>
							<div>
								<span class="stars">
									<% for (let i = 1; i <= 5; i++) { %>
										<% if (i <= Number(r.rating || 0)) { %>
											★
										<% } else { %>
											☆
										<% } %>
									<% } %>
								</span>
							</div>
						</div>
						<% if (r.comment) { %>
							<div class="comment"><%= r.comment %></div>
						<% } else { %>
							<div class="muted" style="margin-top:8px;">No comment provided.</div>
						<% } %>
					</div>
				<% }); %>
			</div>
		<% } else { %>
			<div class="empty">No reviews found.</div>
		<% } %>
	</div>
	<%- include('partials/footer') %>
</body>
</html>
